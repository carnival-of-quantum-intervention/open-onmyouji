# 总述

本工具库集成了在游戏过程中可能用到的部分识别及操作方法。

## 配置格式

工具库自带的配置文件将支持阴阳师的大部分副本，同时您也可以通过修改配置文件支持其它副本甚至其他游戏的识别操作。

### 配置对象

JSON 配置文件的根对象需要 title 属性，这个属性用于根据窗口名称找到该配置文件作用的窗口。除此之外，根对象需要有 config 属性，这是一个数组，由不同副本流程的配置组成。

### 配置名称

副本流程配置需要有 name 属性，指示该副本流程展示在列表中时的名称。

### 配置任务

副本流程配置需要有 task 属性，指示该副本流程需要执行的任务操作。

### 任务种类

任务配置需要有 type 属性，指示该任务节点的种类。此处约定，任务的返回值若为 None，则说明任务出错；任务出错时，若有 otherwise 属性，则将本任务的参数用于执行 otherwise 节点对应的任务，并将其返回值作为本任务的返回值；任务成功时，若有 then 节点，则将原本的返回值作为参数用于执行 then 节点对应的任务，将其返回值作为本任务的返回值返回。换言之，任务采用 Javescript 的 Promise 式控制流。

任务节点可以有如下种类。

#### 定位任务

定位任务指定位一个几何图形，返回值为定位得到的不大于最大偏差率的图形的坐标组成的列表（按偏差率从小到大排序）或无足够匹配的图形时的 None。定位任务可以有如下属性，并至少有一个，但同时指定的颜色和形状暂时不能全部生效。

- 颜色

  即 color 属性，为具有色彩模型 model 和颜色区间 value 属性的对象，目前仅支持 hsv 颜色模型。

- 形状

  即 shape 属性，为形状名称字符串，目前支持的形状有：

  - 圆形 circle

- 宽度比

  即 ratio 属性，为图形宽度与窗口宽度的比值。

- 图形

  即 image 属性，为需要定位的几何图形的文件路径。

#### 点击任务

点击任务指点击传入的坐标，若传入的列表长度大于 1，则选择首个元素，取其前两个元素作为坐标。返回值为点击的坐标或参数不足时的 None。

#### 计数任务

计数任务指对传入的列表长度进行计算，返回值为该长度。

#### 截取任务

截取任务指截取传入的列表前若干项或后若干项，作为返回值返回。需要有 count 属性。

#### 比较任务

比较任务指比较两个数的大小，若小于，则返回空元组，否则返回 None。
